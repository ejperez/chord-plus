!function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t){String.prototype.replaceAll=function(e,t){return this.split(e).join(t)};var s={keys:["C","C#","Db","D","D#","Eb","E","F","F#","Gb","G","G#","Ab","A","A#","Bb","B"],flatKeys:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],sharpKeys:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],noteNames:["C","D","E","F","G","A","B"],keysWithFlats:["F","Bb","Eb","Ab","Db","Gb"],symbolsLookup:["[[:","[[","[[_",":]]","|"],notesDurationLookup:["1","2","4","8","16","1.","2.","4.","8.","16.","1_","2_","4_","8_","16_","1._","2._","4._","8._","16._"],useFlats:!1,steps:0,transposeNote:function(e){var t=s.sharpKeys.indexOf(e);-1===t&&(t=s.flatKeys.indexOf(e));var r=t+s.steps;return r<0?r=s.sharpKeys.length+r:r>=s.sharpKeys.length&&(r-=s.sharpKeys.length),s.useFlats?s.flatKeys[r]:s.sharpKeys[r]},transposeChord:function(e){var t=e.substr(0,1);if(-1===s.noteNames.indexOf(t))throw"Invalid note name";var r=e.substr(1);if("#"===e.substr(1,1)?(t+="#",r=e.substr(2)):"b"===e.substr(1,1)&&(t+="b",r=e.substr(2)),(e=(t=s.transposeNote(t))+r).indexOf("/")>-1){var n=e.substr(e.indexOf("/")+1);e=e.substr(0,e.indexOf("/"))+"/"+s.transposeNote(n)}return e},getItemType:function(e){var t=e.substr(0,1),r=e.substr(e.length-1,1),n=e.substr(0,3);if("["===t&&"]"===r)return{type:"section",value:e.substr(1,e.length-2).replaceAll("-"," ")};if(s.symbolsLookup.hasOwnProperty(n)){if(":]]"===n){var o=e.length>3?e.substr(3):null;return{type:"repeat",value:s.symbolsLookup[e.substr(0,3)],times:2===parseInt(o)?null:o}}return{type:"symbol",value:s.symbolsLookup[e]}}if('"'===t)return{type:"label",value:e.replaceAll('"',"").replaceAll("-"," ")};if("'"===t)return{type:"comment",value:e.replaceAll("'","").replaceAll("-"," ")};if("[["!==e.substr(0,2)){if("("===t){var l=[];return(e=e.replaceAll("(","").replaceAll(")","")).split(",").forEach(function(e){0!==s.steps||s.useFlats?l.push(s.transposeNote(e)):l.push(e)}),{type:"chord",value:"("+l.join(",")+")"}}var a=e,u=null,p="chord";if(-1!==a.indexOf(":")){var i=e.split(":");if(a=i[0],u=i[1],"r"===a&&(p="rest"),"r"!==a&&s.beamsLookup.hasOwnProperty(u))u+=s.beamsLookup[u];else{var f="";u.split(",").forEach(function(e){"r"===a?s.restsDurationLookup.hasOwnProperty(e)&&(f+=s.restsDurationLookup[e]):s.notesDurationLookup.hasOwnProperty(e)&&(f+=s.notesDurationLookup[e])}),u=f}}return{type:p,value:"x"===a||"r"===a?null:s.transposeChord(a),timing:u}}var b=e.substr(2);return useFlats=s.keysWithFlats.indexOf(b)>-1,{type:null,value:null}},parse:function(e,t){var r={title:null,artists:null,key:"C",comment:null,bpm:100,meter:"4/4",body:[]},n="",o=e.trim().split(/\s*[\r\n]+\s*/g);if(0!==o.length){o.forEach(function(e,t){if(t<7){var s=e.split(":");r[s[0]]=s[1]}else n+=e+"\r\n"});var l=s.sharpKeys.indexOf(r.key);if(-1===l&&(l=s.flatKeys.indexOf(r.key)),void 0!==t&&""!==t){var a=s.sharpKeys.indexOf(t);-1===a&&(a=s.flatKeys.indexOf(t)),s.steps=a-l,s.useFlats=s.keysWithFlats.indexOf(t)>-1,(0!==s.steps||s.useFlats)&&(r.key=s.transposeNote(r.key))}var u=n.trim().split(" ");return r.body=[],u.forEach(function(e){if("v2"!==e&&""!==e)if((e.match(/\s*[\r\n]+\s*/g)||[]).length){var t=e.trim().split(/\s*[\r\n]+\s*/g);t.forEach(function(e,n){r.body.push(s.getItemType(e)),n<t.length-1&&r.body.push({type:"break"})})}else r.body.push(s.getItemType(e))}),r}}};e.exports={parse:s.parse}}]);